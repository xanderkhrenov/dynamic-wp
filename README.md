# Dynamic-WP

Dynamic-WP позволяет создать динамический пул воркеров, с помощью которого можно добавлять и удалять воркеры.
Обрабатываемыми данными являются строки, которые преобразуются в "worker `id` processed task: `task`", где `id` - это
номер воркера, совершившего обработку, а `task` - сама строка.

## Реализовано

- Структура `WorkerPool`
  - Динамическое добавление строки (задачи на выполнение)
  - Динамическое добавление воркеров
  - Динамическое удаление воркеров по `id`
  - Динамическое удаление любого из воркеров
  - Завершение работы всех воркеров
- Клиент-сервер с применением `WorkerPool`

## Применение

Для использования структуры в собственном проекте необходимо воспользоваться командой:

```
go get -u github.com/xanderkhrenov/dynamic-wp
```

### Создание `WorkerPool`

```go
wp := workerpool.NewWorkerPool()
```

### Динамическое добавление строки (задачи на выполнение)

```go
err := wp.AddTask(task string)
```

Возникает ошибка в случае, если на данный момент нет активных воркеров.

### Динамическое добавление воркеров

```go
id := wp.AddWorker() // где id - номер добавленного воркера
```

### Динамическое удаление воркеров по `id`

```go
err := wp.DeleteWorker(id) // где id - номер удаленного воркера
```

Возникает ошибка в случае, если отсутствует воркер с заданным `id`.

### Динамическое удаление любого из воркеров

```go
id, err := wp.DeleteAnyWorker() // где id - номер удаленного воркера
```

Возникает ошибка в случае, если в пуле нет ни одного воркера.

### Завершение работы всех воркеров

```go
wp.Shutdown()
```

## Пример использования: клиент-сервер

Приложение написано для запуска на локальном компьютере, то есть и клиент, и сервер запускаются на одном устройстве.

Для запуска приложений необходимо склонировать проект:

```
git clone https://github.com/xanderkhrenov/dynamic-wp.git
```

После этого из корня проекта запускаем сначала сервер:

```
go run ./cmd/server/main.go
```

Затем запускаем произвольное количество клиентов:

```
go run ./cmd/client/main.go
```

Клиент имеет возможность ввести следующие команды:

- task `task` (добавление строки `task` для обработки)
- add (добавление нового воркера)
- del `id` (удаление воркера с номером `id`)
- del (удаление любого из воркеров)
- quit (завершение работы клиента)

Завершить работу сервера можно с помощью сигнала прерывания (Ctrl+C).